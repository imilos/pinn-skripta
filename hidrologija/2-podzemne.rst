.. _podzemne:

Филтрација подземних вода
================================

Основна величина од које се полази у теорији струјање течности кроз порозно тле је потенцијал :math:`\phi` дефинисан као

.. math:: 
    \phi = \frac{p}{\gamma} + h

где је :math:`p` притисак течности, :math:`\gamma` специфична тежина, а :math:`h` висина у вертикалном правцу мерена у односу на изабрану референтну раван. Брзина течности **q**, позната и као Дарсијева брзина, представља запремину течности која прође у јединици времена кроз јединичну површину порозне средине. Она се може изразити помоћу потенцијала :math:`\phi` релацијом која се зове Дарсијев закон:

.. math:: 
    \mathbf{q} = -\mathbf{K} \nabla \phi, 

где је **K** матрица пермеабилности која за ортотропни материал има облик

.. math:: 
    \mathbf{K} = 
    \begin{bmatrix}
    k_x & 0 & 0 \\
    0 & k_y & 0 \\
    0 & 0 & k_z 
    \end{bmatrix} 

где су :math:`k_x`, :math:`k_y` и :math:`k_z` коефицијенти пермеабилости у  одговарајућим правцима. Kомпонентни облик једначине је према томе:

.. math:: 
    q_x = -k_x \frac{\partial \phi}{\partial x}, \\
    q_y = -k_y \frac{\partial \phi}{\partial y}, \\
    q_z = -k_z \frac{\partial \phi}{\partial z}.

Сада у систем уводимо једначину континуитета. У случају стационарног струјања нестишљивог флуида, каква је вода, једначина континуитета има облик

.. math:: 
    \nabla^T \mathbf{q} = 0,

или уз коришћење Дарсијевог закона

.. math:: 
    \frac{\partial}{\partial x}\left( k_x \frac{\partial \phi}{\partial x} \right) +
    \frac{\partial}{\partial y}\left( k_y \frac{\partial \phi}{\partial y} \right) +
    \frac{\partial}{\partial z}\left( k_z \frac{\partial \phi}{\partial z} \right) = 0

У случају када се промена коефицијената :math:`k_x, k_y, k_z` са координатама може занемарити, што је најчешћи случај, једначина  се своди на

.. math:: 
    k_x \frac{\partial^2\phi}{\partial x^2} +
    k_y \frac{\partial^2\phi}{\partial y^2} +
    k_z \frac{\partial^2\phi}{\partial z^2} = 0

Коначно, ако постоји извор и/или понор, за стационарне услове, **хидродинамичка једначина** има следећи облик:

.. math:: 
    :label: eq:hidrodinamicka

    k_x \frac{\partial^2\phi}{\partial x^2} +
    k_y \frac{\partial^2\phi}{\partial y^2} +
    k_z \frac{\partial^2\phi}{\partial z^2} + \bar{Q}= 0

где је :math:`\bar{Q}` запремински флукс (извор или понор као количина течности по јединици запремине порозне средине). 

Гранични услови који се срећу у решавању проблема струјања кроз порозну средину описаног горњим једначинама приказани су на .

Они могу бити:

#. **задат потенцијал**
    .. math::
        \phi = \bar{\phi}, \qquad \text{на } \Gamma_1

#. **задат површински проток (флукс)**
    .. math::
        q_n = \bar{q} \qquad \text{на } \Gamma_2
	
#. **слободна површина**
    .. math::
        p=0, \, \phi=z, \, \frac{\partial \phi}{\partial n}=0 \qquad \text{на }  \Gamma_3

Приметимо да је на слободној површини :math:`\phi=z`. Пошто се облик слободне површине не зна, то је њено одређивање посебан задатак у овој области. И овај проблем ћемо покушати да покријемо ФЗНН методом. 


2-Д стационарно струјање кроз порозну средину без слободне површине
---------------------------------------------------------------------

Дводимензионални стационарни ток кроз порозни медијум је регулисан константном разликом потенцијала на две површине. Проток се јавља између два непропусна слоја у правоугаоној геометрији димензија *2m x 2m*. ПОставка проблема је прилично једноставна и њени најважнији делови се налазе на следећем листингу. 

.. code-block:: python
    :caption: Решење проблема филтрације без слободне површине у 2Д коришћењем SCIANN библиотеке
    :linenos:

    # Osnovni grid
    x_data, y_data = np.meshgrid(
        np.linspace(0, 2, 201), 
        np.linspace(0, 2, 201)
    )

    # Modeluje se phi(x,y)
    x = sn.Variable('x')
    y = sn.Variable('y')
    phi = sn.Functional('phi', [x,y], 4*[30], 'sigmoid')

    # %%
    k = 1.е-5
    TOL = 0.015

    # Osnovna jednacina
    fun1 = k * (diff(phi, x, order=2) + diff(phi, y, order=2))

    # Dirihleovi granicni uslovi
    C1 = (1-sign(x - (0+TOL))) * (phi-2)
    C2 = (1+sign(x - (2-TOL))) * (phi-1) 

    # Njumanovi granicni uslovi
    N1 = (1-sign(y - (0+TOL))) * diff(phi,y)
    N2 = (1+sign(y - (2-TOL))) * diff(phi,y)

    # FZNN model
    m2 = sn.SciModel([x,y], [fun1, C1, C2, N1, N2],  optimizer='Adam')

    # Trening
    pinn_model = m2.train([x_data, y_data], 5*['zero'], learning_rate=0.001, batch_size=1024, epochs=100, stop_loss_value=1E-15)

Са свим овим поставкама смо се мање-више већ сретали, осим што до сада нисмо имали 2Д стационарни проблем. Постављамо равномерни грид колокационих тачака у димензијама домена (*2m x 2m*), затим дефинишем функционал :math:`\Phi(x,y)` и диференцијалну једначину проблема. Приметимо да решење уопште не би требало да зависи од коефицијента *k*. Следећи корак је поставка Дирихелових граничних услова на левом (:math:`\Phi_1=2m`) и на десном (:math:`\Phi_1=1m`) крају домена, тј. на вертикалама :math:`x_1=0m` и :math:`x=2m` респективно:

.. code-block:: python

    C1 = (1-sign(x - (0+TOL))) * (phi-2)
    C2 = (1+sign(x - (2-TOL))) * (phi-1)

Недостају само још Њуманови гранични услови који јамче да су доња (*y=0*) и горња (*y=2m*) површина непропусне, тј. да је извод потенцијала по *y* једнак нули:

.. code-block:: python

    N1 = (1-sign(y - (0+TOL))) * diff(phi,y)
    N2 = (1+sign(y - (2-TOL))) * diff(phi,y)

Када се постави проблем, решење се назире већ за неколико десетина епоха тренирања. Аналитичко решење за потенцијал је, према :cite:t:`bear2012hydraulics`:

.. math:: 
    \Phi = \Phi_1 - \frac{\Phi_1-\Phi_2}{L} (x-x_1)

где је :math:`L=x_2-x_1`. Дакле, потенцијално поље је једнолично у односу на *Y* координату, док је градијент потенцијала константан у правцу *X* осе. 

.. _bez-slobodne-povrsine-res1:

.. figure:: 2d-filtracija-bez-sp1.png
    :width: 80%

    ФЗНН решење потенцијала дуж *X* осе за 2Д случај филтрације без слободне површине.

Поређење аналитичког и ФЗНН решења је приказано на :numref:`bez-slobodne-povrsine-res1`, а потенцијално поље је приказано на :numref:`bez-slobodne-povrsine-res2`. Униформност потенцијалног поља у *Y* смеру, показује тачност 2Д ФЗНН решења за овај стационарни проблем.

.. _bez-slobodne-povrsine-res2:

.. figure:: 2d-filtracija-bez-sp2.png
    :width: 80%

    ФЗНН решење поља потенцијала за 2Д случај филтрације без слободне површине.


2-Д стационарно струјање кроз порозну средину са слободном површином
----------------------------------------------------------------------
