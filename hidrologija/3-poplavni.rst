.. _poplavni:

Пропагација поплавног таласа у отвореном каналу
==================================================

Управљање водним ресурсима захтева алате за дугорочно и краткорочно предвиђање различитих хидролошких феномена (нпр. хидрограми степена и протока). То је значајно у области управљања ризиком од поплава, контроле хидроелектрана, унутрашње пловидбе, водоснабдевања, итд. Бројни задаци у вези са предвиђањем хидролошких података успешно су обрађени коришћењем приступа предвиђања заснованог на класичном нумеричком моделовању. Иако овај приступ даје добре резултате и представља неизбежан корак, још увек има много проблема које треба решити. У многим случајевима, време рачунања је параметар који може ограничити примену физички заснованих хидролошких и хидрауличних модела у реалној примени. Поред тога, физички засновани модели су недовољно флексибилни у случајевима инверзних проблема, идентификације параметара, увођења експерименталних података итд. 

Модели предвиђања засновани на АНН примењени су у моделовању падавина и отицаја :cite:t:`chadalawada2020hydrologically`, системима раног упозорења на поплаве :cite:t:`duncan2013rapids` и моделовању урбаних водоводних мрежа :cite:t:`garzon2022machine`. Ови приступи захтевају велику количину података за обуку, што може створити проблеме уколико нема довољно података. Поред тога, може се приметити да ова врста модела није у стању да да добре резултате када улазни подаци излазе изван опсега података који се користе за обуку. У овим случајевима, АНН модели могу произвести физички немогуће резултате. У последњих неколико година убрзано се уводи ФЗНН приступ и у овој области. У овом примеру ћемо сагледати потенцијал коришћења ФЗНН у једнодимензионом проблему пропагације поплавног таласа у отвореним каналима спајањем физичког закона са почетним и граничним условима описаним кинематичкком једначином пропагације таласа.

Усмеравање поплава - физички закони
-------------------------------------

Ширење поплавног таласа (усмеравање поплава) у отвореним каналима је описано помоћу две једначине, и то **једначином континуитета** :math:numref:`eq:poplava-kontinuitet` и **законом одржања импулса** :math:numref:`eq:poplava-dinamicka`. Ова једначина садржи утицаје трења, гравитације, силе притиска као и локалног и конвективног убрзања. У овом примеру, усмеравање поплава у правоугаоном каналу је представљено кинематичким таласом који поједностављује динамичку једначину узимајући само утицај трења и гравитације:

.. math:: 
  :label: eq:poplava-kontinuitet

  \frac{\partial h(x,t)}{\partial t} + c \frac{\partial h(x,t)}{\partial x} = 0 

.. math:: 
  :label: eq:poplava-dinamicka
  
  Q(x,t) = \frac{1}{n} \cdot B \cdot h(x,t)^\frac{5}{3} \cdot \sqrt{I_d},

где *h [m]* представља дубину воде, *t [s]* је време, *x [m]* просторну координату, *c [m/s]* брзину пропагације поремећаја, :math:`Q [m^3/s]`` даје проток (пражњење), :math:`n [m^{-\frac{1}{3}}s]` репрезентује Манингову храпавост, *B [m]* ширину попречног пресека и :math:`I_d` нагиб по уздужној оси. 

Циљ моделовања усмеравања поплава је процена промене дубине воде дуж канала *h(x,t)* изазвана поплавним таласом представљеним хидрографом тока :math:`Q_{in}(t) = Q(0,t)` на узводној граници.

Конструкција функције губитка
-------------------------------

Ако се осврнемо на општи израз за функцију губитка :math:numref:`eq:loss1`, видимо три компоненте, и то губитак који потиче од резидуалне мреже, губитак који потиче од почетних услова и губитак који потиче од граничних услова. Кренимо редом. Компонента функције губитка која потиче од диференцијалне једначине :math:numref:`eq:poplava-kontinuitet` дефнисана је десном страном исте једначине. Компонента почетних услова се дефинише као:

.. math:: 
  h(x,t=0) = h_0

Поред тога, потребан нам је и гранични услов који дефинише вредност висине таласа на почетку моделованог домена, тј. на *x=0* одакле талас долази. Тај гранични услов изводимо из динамичке једначине :math:numref:`eq:poplava-dinamicka`:

.. math:: 
  h(0,t) = \left(  \frac{Q_{in}(t) \cdot n}{B \cdot \sqrt{I_d}}  \right)^\frac{3}{5}.

Уколико као меру грешке усвојимо средњу квадратну грешку (*Mean Squared Error - MSE*), композитнља функција губитка изгледаће овако:

.. math:: 
  MSE = MSE_r + MSE_0 + MSE_b

где су:

.. math:: 
  MSE_r = \frac{1}{N_{x_f,t_f}} \sum \left| r(x_f, t_f) \right|^2, \\
  MSE_0 = \frac{1}{N_{x_0,t_0}} \sum \left| \tilde{h}(x_0,0)-h(x_0,0) \right|^2, \\
  MSE_b = \frac{1}{N_{x_b,t_b}} \sum \left| \tilde{h}(0,t_b)-h(0,t_b) \right|^2.

Овде су :math:`N_{x_f,t_f}`, :math:`N_{x_0,t_0}` и :math:`N_{x_b,t_b}` укупни бројеви колокационих тачака у унутрашњости моделованог домена, за почетне и за граничне услове, респективно. 
 
Тест пример и имплементација
-----------------------------

Пример на коме ћемо тестирати ваљаност нашег ФЗНН приступа за моделовање усмеравања поплавног таласа је пропагација таласа дуж канала дугог 1600 метара, облика призме и правоугаоног попречног пресека широког 15 метара, као на :numref:`poplavni-postavka`. 

.. _poplavni-postavka:

.. figure:: poplavni1.png
    :width: 80%

    Поставка проблема пропагације поплавног таласа у времену.

Манингова храпавост има вредност од :math:`n = 0,015 m^{-\frac{1}{3}}s`, нагиб је постављен на :math:`I_d=0,005`, a брзина пропагације на :math:`c=15 m/s`. Циљ је израчунати промене дубине и протока воде дуж канала, изазване поплавним таласом генерисаним као узводни гранични услови (*x=0*):

.. math:: 
  Q_{in}(t) = Q(0,t) = 180 \cdot \left[  1 + \left( -\frac{sgn(t-600)}{2} + \frac{1}{2} \right) \cdot \sin \left( \frac{\pi t}{600} \right)  \right].

Такође, на почетку је висина воде у каналу *h(x,t=0)=1,751m*. 

