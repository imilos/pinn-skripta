.. _akustika_socivo:

Дводимензиони проблем са сочивом
======================================

Овај одељак се бави нешто модификованим `примером из туторијала <https://www.dealii.org/current/doxygen/deal.II/step_29.html>`_ за познати софтверски оквир за рад са методом коначних елемената **Deal.II**. Првобитна сврха овог примера је да симулира својства фокусирања ултразвучног таласа који генерише сочиво претварача са променљивом геометријом. Недавне примене у медицинском имиџингу користе ултразвучне таласе не само за сврхе снимања, већ и за изазивање одређених локалних ефеката у материјалу, као што су промене у оптичким својствима, које се затим могу мерити другим техникама снимања. Витални састојак ових метода је способност фокусирања интензитета ултразвучног таласа у одређеном делу материјала, идеално у тачки, како би се могла испитати својства материјала на тој локацији.

Међутим, карактеристична таласна дужина ултразвука нешто мања од феномена које смо до сада моделовали ФЗНМ методом, те би нам био потребан изузетно велики број колокационих тачака што продужава тренирање. Зато смо таласну дужину нешто повећали (смањили фреквенцију), док остале параметре нисмо мењали. 

Како бисмо извели једначине за овај проблем, звук узимамо као талас којим се шири промена притиска: 

.. math::
    \frac{\partial^2 U}{\partial t^2} - c^2 \Delta U = 0


где је *c* брзина звука (која се због једноставности узима константом), :math:`U = U(x,t) ,\; x \in \Omega, \; t \in \mathrm{R}`. Поставка проблема дата је на :numref:`akustika-socivo`.

.. _akustika-socivo:

.. figure:: akustika3.png
    :width: 60%

    Поставка проблема и гранични услови.


Граница :math:`\Gamma=\partial\Omega` подељена је на два дела, и то :math:`\Gamma_1` и :math:`\Gamma_2=\Gamma\setminus\Gamma_1`, где :math:`\Gamma_1` представља сочиво, а :math:`\Gamma_2` апсорбујућу границу. Заправо, желимо да направимо такав гранични услов на :math:`\Gamma_2` тако да се опонаша знатно већи домен. На :math:`\Gamma_1`, претварач генерише таласе константне фреквенције :math:`\omega \gt 0` и константне јединичне амплитуде:

.. math::
    U(x,t) = \cos{\omega t}, \qquad x\in \Gamma_1

Пошто нема других (интерних или граничних) извора и пошто само извор емитује таласе фреквенције :math:`\omega`, дозвољено је да извршимо раздвајање променљивих :math:`U(x,t) = \textrm{Re}\left(u(x)\,e^{i\omega t})\right)`. Комплексна функција :math:`u(x)` описује просторну зависност амплитуде и фазе (релативно у односу на извор) таласа фреквенције :math:`\omega`, док је амлитуда вечличина која нас интересује. Ако овако формулисану функцију уврстимо у таласну једначину, видимо да за *u* имамо

.. math::
    -\omega^2 u(x) - c^2\Delta u(x) = 0, \qquad x \in \Omega, \\
    u(x) = 1,  \qquad x \in \Gamma_1.

Да бисмо нашли одговарајуће граничне услове на :math:`\Gamma_2` који опонашају апсорбујућу границу, размотримо талас облика :math:`V(x,t)=e^{i(k\cdot x - \omega t)}` фреквецније :math:`\omega` који се простире у правцу :math:`k \in {\mathrm{R}^2}`. Да би :math:`V` био решење таласне једначине, мора да важи :math:`|k|=\frac{\omega}{c}`. Претпоставимо да талас долази до :math:`x_0 \in \Gamma_2` под правим углом, на пример :math:`n=\frac{k}{|k|}` где *n* означава нормалу на :math:`\Omega\) \in \(x_0`. Онда у :math:`x_0`, овај талас задовољава једначину

.. math::
    c (n\cdot\nabla V) + \frac{\partial V}{\partial t} = (i\, c\, |k| - i\, \omega) V = 0.

Постављањем граничног услова

.. math::
    c (n\cdot\nabla U) + \frac{\partial U}{\partial t} = 0, \qquad x\in\Gamma_2,

таласи који ударају у границу :math:`\Gamma_2` под правим углом биће савршено апсорбовани. Са друге стране, они делови таласног поља који не падају под правим углом не задовољавају овај услов, па ће долазити до парцијалних рефлексија. У основи, директни делови таласа ће проћи кроз границу као да она не постоји, док ће остали бити реглектовани назад у домен.

Уколико смо спремни да прихватимо овако предложену апроксимацију, онда за :math:`u` важи следеће: 

.. math::
    :label: eq:sistem

    -\omega^2 u - c^2\Delta u = 0, \qquad x \in \Omega, \\
    c (n\cdot\nabla u) + i\,\omega\, u=0, \qquad x \in \Gamma_2, \\
    u=1,  \qquad x \in \Gamma_1.

препознајемо Хелмхолцову једначину са Дирихлеовим условом на :math:`\Gamma_1` и мешаним граничним условом на :math:`\Gamma_2`. Због услова на :math:`\Gamma_2` не можемо да третирамо релане и имагинарне делове :math:`u` посебно. Оно што можемо да урадима је да формирамо систем од две парцијалне диференцијалне једначине у којима фигуришу реални и имагинарни део :math:`u`, са граничним условима на :math:`\Gamma_2` које везују ове две компоненте. Ако означимо да је :math:`v=\textrm{Re}\;u,\; w=\textrm{Im}\;u`, систем :math:numref:`eq:sistem` гласи:  

.. math::
    :label: eq:sistem1

    -\omega^2 v - c^2 \Delta v=0 \quad \\
    -\omega^2 w - c^2 \Delta w=0 \quad \\
    x \in \Omega,
        \\
    c (n\cdot\nabla v) - \omega \, w=0 \quad \\
    c (n\cdot\nabla w) + \omega \, v=0 \quad \\
    x \in \Gamma_2, 
    \\
    v=1 \quad \\
    w=0 \quad \\
    x \in \Gamma_1.

Дакле, прве две једначине важе у целом домену :math:`\Omega`, друге две на граници :math:`\Gamma_2` и последље две на :math:`\Gamma_1`. Овде први пут имамо систем диференцијалних једначина, али ни то не би требало да буде велики проблем за ФЗНН методу, ако подразумевамо да је систем затворен и једнозначан. Пре


Имплементација
-----------------

На основу система једначина :math:numref:`eq:sistem1` треба да формирамо композитну функцију губитка, да формирамо ФЗНМ мрежу и да је истренирамо на довољном броју колокационих тачака. Ево кључних делова имплементације остварене помоћу оквира SCIANN:

